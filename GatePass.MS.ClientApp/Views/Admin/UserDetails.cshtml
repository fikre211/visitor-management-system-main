@using GatePass.MS.Domain.ViewModels
@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer
@model ViewUserViewModel
@{
    ViewData["Title"] = "User Detail";
}

<section class="content-header" style="padding: 20px 30px;">
    <h1 style="font-size:26px; font-weight:600; color:#1565c0;">
        @Localizer["User Profile"]
    </h1>
</section>

<section class="content" style="padding: 0 30px;">
    <div class="container-fluid">

        <div class="card" style="border-radius:14px; padding:20px;">

            <!-- TOP PROFILE SECTION -->
            <div style="display:flex; gap:30px; align-items:center;">

                <!-- IMAGE -->
                <img src="../../dist/img/user4-128x128.jpg"
                     class="img-circle"
                     style="width:120px; height:120px; object-fit:cover; border:3px solid #1e88e5; border-radius:50%;" />

                <!-- USER INFO -->
                <div style="flex:1;">
                    <h2 style="margin:0; font-size:22px; font-weight:600; color:#1565c0;">
                        @Model.UserName
                    </h2>

                    <p style="margin-top:8px; font-size:15px;">
                        <b>@Localizer["Department"]:</b> @Model.Department
                    </p>

                    <!-- ACCOUNT STATUS UI -->
                    <div style="margin-top:10px;">
                        <b>@Localizer["Current Status of account"]:</b><br />

                        @if (!Model.IsActive)
                        {
                            <span class="btn btn-warning btn-sm" style="margin-top:5px;">Deactive</span>
                        }
                        else
                        {
                            <span class="btn btn-success btn-sm" style="margin-top:5px;">@Localizer["Active"]</span>
                        }

                        @if (Model.IsLocked)
                        {
                            <span class="btn btn-danger btn-sm" style="margin-left:5px;">@Localizer["Locked"]</span>
                        }
                    </div>

                </div>
            </div>

            <hr style="margin:25px 0;" />

            <!-- ACCOUNT ACTIONS -->
            <div>

                <h5 style="font-weight:600; margin-bottom:10px;">
                    @Localizer["Change Account Status"]
                </h5>

                <!-- ACTIVE / DEACTIVE LOGIC -->
                @if (!Model.IsActive)
                {
                    <form asp-action="ActivateUser" method="post" style="margin-bottom:10px;">
                        <input type="hidden" asp-for="Id" />
                        <button type="submit" class="btn btn-success">Activate</button>
                    </form>
                }
                else
                {
                    <form asp-action="DeactivateUser" method="post" style="margin-bottom:10px;">
                        <input type="hidden" asp-for="Id" />
                        <button type="submit" class="btn btn-warning">Deactivate</button>
                    </form>
                }

                <!-- UNLOCK BUTTON -->
                @if (Model.IsLocked)
                {
                    <form asp-action="UnlockUser" method="post" style="margin-top:10px;">
                        <input type="hidden" asp-for="Id" />
                        <button type="submit" class="btn btn-danger">Unlock Account</button>
                    </form>
                }

            </div>

        </div>

        <!-- ACTIVITY SECTION -->
        <div class="card" style="margin-top:25px; border-radius:14px;">
            <div class="card-header" style="background:#e3f2fd; border-radius:14px 14px 0 0;">
                <h4 style="margin:0; color:#1565c0; font-weight:600;">
                    @Localizer["Activity Log"]
                </h4>
            </div>

            <div class="card-body" style="padding:20px;">

                <table class="table table-bordered" style="border-radius:10px; overflow:hidden;">
                    <thead style="background:#e3f2fd; color:#1565c0; font-weight:600;">
                        <tr>
                            <th>@Localizer["Timestamp"]</th>
                            <th>@Localizer["Activity Type"]</th>
                            <th>@Localizer["Activity Description"]</th>
                        </tr>
                    </thead>

                    <tbody>
                        @foreach (var activity in ViewBag.activities)
                        {
                            <tr>
                                <td>
                                    <span style="background:#1e88e5; color:#fff; padding:6px 12px; border-radius:6px; font-size:12px;">
                                        @activity.Timestamp.ToString("MMM d, yyyy h:mm tt")
                                    </span>
                                </td>
                                <td style="font-weight:600; color:#1565c0;">
                                    @activity.ActivityType
                                </td>
                                <td style="color:#444;">
                                    @activity.ActivityDescription
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>

            </div>
        </div>

    </div>
</section>
