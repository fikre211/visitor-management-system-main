@model IEnumerable<GatePass.MS.Domain.Employee>
@using GatePass.MS.Domain
@using Microsoft.AspNetCore.Identity
@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer

@{
    ViewData["Title"] = "Employee List";
}

<div style="padding:30px; background:#f7faff; font-family:Segoe UI, Arial, sans-serif;">

    <div style="display:flex; justify-content:space-between; align-items:flex-start; margin-bottom:25px;">
        <a id="createNew"
           class="btn btn-primary"
           style="cursor:pointer; background:#007bff; border-color:#007bff; padding:10px 20px; border-radius:8px; font-weight:600; box-shadow:0 2px 4px rgba(0,0,0,0.1);">
            <i class="fas fa-plus mr-2"></i> @Localizer["addNewEmployee"]
        </a>
    </div>

    <form method="post" enctype="multipart/form-data" style="margin-bottom:25px; padding:15px; border:1px solid #cce5ff; border-radius:8px; background:#eef5ff; box-shadow:0 1px 3px rgba(0,0,0,0.05);">
        <div class="row align-items-end">
            <div class="col-md-4">
                <label style="font-weight:600; margin-bottom:5px; color:#0056b3;">@Localizer["Select Excel File"]</label>
                <input type="file" name="file" class="form-control" style="border-radius:4px; border-color:#b3d7ff;" />
            </div>
            <div class="col-md-3">
                <input type="submit"
                       asp-controller="Employees"
                       asp-action="UploadExcel"
                       class="btn btn-primary"
                       value="Upload Excel File"
                       style="background:#007bff; border-color:#007bff; padding:8px 18px; border-radius:6px; margin-top:28px;" />
            </div>
        </div>
    </form>


    <div class="modal fade" id="modal-lg">
        <div class="modal-dialog modal-lg">
            <div class="modal-content"></div>
        </div>
    </div>

    <div class="modal fade" id="modal-sm">
        <div class="modal-dialog modal-sm">
            <div class="modal-content"></div>
        </div>
    </div>

    @* --- TABLE SECTION --- *@
    <div style="background:white; border-radius:10px; box-shadow:0px 4px 10px rgba(0,0,0,0.1);">
        
        @* Removed min-width style to prevent forcing scrollbar *@
        <div>
            @* Removed 'text-nowrap' class so text can wrap to fit the screen width *@
            <table id="myDataTable" class="table table-hover table-head-fixed" style="font-size:14px; width:100%; border-collapse: separate; border-spacing: 0;">
                <thead style="position: sticky; top: 0; z-index: 1; background-color: #007bff; color: white;">
                    <tr>
                        <th style="padding:12px; border:none; color:white; background:#007bff; width:40px;">#</th>
                        <th style="padding:12px; border:none; color:white; background:#007bff;">@Localizer["firstName"]</th>
                        <th style="padding:12px; border:none; color:white; background:#007bff;">@Localizer["fatherName"]</th>
                        <th style="padding:12px; border:none; color:white; background:#007bff;">@Localizer["email"]</th>
                        <th style="padding:12px; border:none; color:white; background:#007bff;">@Localizer["phone"]</th>
                        <th style="padding:12px; border:none; color:white; background:#007bff;">@Localizer["gender"]</th>
                        <th style="padding:12px; border:none; color:white; background:#007bff;">@Localizer["address"]</th>
                        <th style="padding:12px; border:none; color:white; background:#007bff;">@Localizer["age"]</th>
                        <th style="padding:12px; border:none; color:white; background:#007bff;">@Localizer["department"]</th>
                        <th style="padding:12px; border:none; color:white; background:#007bff;">@Localizer["designation"]</th>
                        @* Reduced width for Actions column *@
                        <th style="padding:12px; border:none; color:white; background:#007bff; width:110px; text-align:center;">@Localizer["action"]</th>
                    </tr>
                </thead>
                <tbody>
                    @{
                        int index = 0;
                    }
                    @foreach (var item in Model)
                    {
                        index++;
                        var bgColor = index % 2 == 0 ? "#f8faff" : "white";
                        <tr style="background:@bgColor; border-bottom: 1px solid #eee;">
                            <td style="padding:10px; vertical-align:middle;">@(index )</td>
                            <td style="padding:10px; vertical-align:middle;">@item.FirstName</td>
                            <td style="padding:10px; vertical-align:middle;">@item.LastName</td>
                            <td style="padding:10px; vertical-align:middle; word-break:break-word;">@item.Email</td>
                            <td style="padding:10px; vertical-align:middle;">@item.Phone</td>
                            <td style="padding:10px; vertical-align:middle;">@item.Gender</td>
                            <td style="padding:10px; vertical-align:middle;">@item.Address</td>
                            <td style="padding:10px; vertical-align:middle;">@item.Age</td>
                            <td style="padding:10px; vertical-align:middle;">@item.Department.Name</td>
                            <td style="padding:10px; vertical-align:middle;">@item.Designation.Name</td>

                            <td style="padding:10px; text-align:center; vertical-align:middle;">
                                @* Detail Button *@
                                <a onclick="showDetails(@item.Id)"
                                   title="@Localizer["detail"]"
                                   style="cursor:pointer; background:#2d7dff; color:white; padding:6px 10px; border-radius:6px; text-decoration:none; font-size:12px; margin:1px; display:inline-block; border:none;">
                                    <i class="fas fa-info-circle"></i>
                                </a>

                                @* Edit Button *@
                                <a onclick="editEmployee(@item.Id)"
                                   title="@Localizer["edit"]"
                                   style="cursor:pointer; background:#4db8ff; color:white; padding:6px 10px; border-radius:6px; text-decoration:none; font-size:12px; margin:1px; display:inline-block; border:none;">
                                    <i class="fas fa-edit"></i>
                                </a>

                                @* Delete Button *@
                                <a onclick="deleteEmployee(@item.Id)"
                                   title="@Localizer["delete"]"
                                   style="cursor:pointer; background:#ff4d4d; color:white; padding:6px 10px; border-radius:6px; text-decoration:none; font-size:12px; margin:1px; display:inline-block; border:none;">
                                    <i class="fas fa-trash-alt"></i>
                                </a>
                            </td>
                        </tr>
                        @* @{ index++; }  *@
                    }
                </tbody>
            </table>
        </div>
    </div>

</div>
<style>
    /* Force table borders to collapse into single lines */
    #myDataTable {
        border-collapse: collapse !important;
    }

        /* Add a visible border to every header and cell */
        #myDataTable th,
        #myDataTable td {
            border: 1px solid #a0a0a0 !important; /* Dark grey visible border */
        }
</style>

@section Scripts {
    <script>
        $(document).ready(function () {
            $('#createNew').click(function () {
                $.get('@Url.Action("Create", "Employees")', function (data) {
                    $('#modal-lg .modal-content').html(data);
                    $('#modal-lg').modal('show');
                });
            });
        });

        function showDetails(id) {
            $.get('@Url.Action("Details", "Employees")/' + id, function (data) {
                $('#modal-lg .modal-content').html(data);
                $('#modal-lg').modal('show');
            });
        }

        function editEmployee(id) {
            $.get('@Url.Action("Edit", "Employees")/' + id, function (data) {
                $('#modal-lg .modal-content').html(data);
                $('#modal-lg').modal('show');
            });
        }

        function deleteEmployee(id) {
            $.get('@Url.Action("Delete", "Employees")/' + id, function (data) {
                $('#modal-lg .modal-content').html(data);
                $('#modal-lg').modal('show');
            });
        }
    </script>
}