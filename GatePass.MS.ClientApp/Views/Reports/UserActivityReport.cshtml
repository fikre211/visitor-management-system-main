@using GatePass.MS.Domain.ViewModels
@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer
@model UserActivityReportModel

@{
    ViewBag.Title = "User Activity Report";

}

<div style="padding: 30px;">
    <div class="row">
        <div class="col-12">
            <div class="card" style="border-top: 4px solid #007bff; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-left: none; border-right: none; border-bottom: none;">
                
                <div class="card-header" style="background-color: #f0f7ff; border-bottom: 1px solid #cce5ff; padding: 20px;">
                    <form asp-action="UserActivityReport" method="get" class="row g-3 align-items-end">
                        
                        <div class="col-md-3 form-group">
                            <label for="startDate" style="color: #0056b3; font-weight: 600; margin-bottom: 5px;">@Localizer["Start Date"]:</label>
                            <input type="date" id="startDate" name="startDate" value="@Model.StartDate?.ToString("yyyy-MM-dd")" class="form-control" />
                        </div>
                        
                        <div class="col-md-3 form-group">
                            <label for="endDate" style="color: #0056b3; font-weight: 600; margin-bottom: 5px;">@Localizer["End Date"]:</label>
                            <input type="date" id="endDate" name="endDate" value="@Model.EndDate?.ToString("yyyy-MM-dd")" class="form-control" />
                        </div>
                        
                        <div class="col-md-4 form-group">
                            <label asp-for="SelectedUserId" style="color: #0056b3; font-weight: 600; margin-bottom: 5px;">@Localizer["Select User"]</label>
                            <select asp-for ="SelectedUserId" class="form-control" asp-items="Model.Users">
                                <option value="">@Localizer["All Users"]</option>
                            </select>
                        </div>
                        
                        <div class="col-md-2 form-group">
                            <button type="submit" class="btn btn-primary px-4" style="background-color: #007bff; border-color: #007bff; color: white; margin-top: 25px;">
                                Filter <i class="fa fa-filter ml-1"></i>
                            </button>
                        </div>

                    </form>
                </div>
                <div class="card-body p-0" style="height: 500px; overflow-y: auto;">
                    
                    <div style="overflow-x: auto;">
                        <table id="myDataTable" class="table table-hover table-head-fixed text-nowrap">
                            <thead style="background-color: #007bff; color: black;">
                                <tr>
                                    <th>@Localizer["Timestamp"]</th>
                                    <th>@Localizer["User Id"]</th>
                                    <th>@Localizer["Activity Type"]</th>
                                    <th>@Localizer["Activity Description"]</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var activity in Model.Activities)
                                {
                                    <tr>
                                        <td class="align-middle">@activity.Timestamp.ToString("MMM d, yyyy h:mm tt")</td>
                                        <td class="align-middle font-weight-bold">@activity.UserName</td>
                                        <td class="align-middle">
                                            @{
                                                string activityStyle = "";
                                                // Simple color coding based on activity type for better visibility
                                                if (activity.ActivityType?.Contains("Login") == true || activity.ActivityType?.Contains("Approved") == true)
                                                {
                                                    activityStyle = "color: #28a745; font-weight: bold;"; // Green for success/positive
                                                }
                                                else if (activity.ActivityType?.Contains("Failed") == true || activity.ActivityType?.Contains("Rejected") == true)
                                                {
                                                    activityStyle = "color: #dc3545; font-weight: bold;"; // Red for failure/negative
                                                }
                                                else
                                                {
                                                    activityStyle = "color: #007bff;"; // Blue for generic
                                                }
                                            }
                                            <span style="@activityStyle">@activity.ActivityType</span>
                                        </td>
                                        <td class="align-middle">@activity.ActivityDescription</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                    </div>
                </div>
            </div>
    </div>
</div>